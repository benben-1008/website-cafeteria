<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>å­¦æ ¡é£Ÿå ‚ - ç”Ÿå¾’ç”¨ã‚µã‚¤ãƒˆ</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <h1>ğŸ½ï¸ å­¦æ ¡é£Ÿå ‚</h1>
      <p>ç”Ÿå¾’ç”¨ã‚µã‚¤ãƒˆ</p>
    </header>

    <main>
      <section class="status-section">
        <h2>ğŸ“… å–¶æ¥­çŠ¶æ³</h2>
        <div id="status-display" class="status-card"></div>
      </section>

      <section class="info-section">
        <h2>ğŸ“… ä»Šå¾Œã®ä¼‘æ¥­æ—¥</h2>
        <div id="holidays-list" class="info-card"></div>
      </section>

      <section class="info-section">
        <h2>ğŸ“… å–¶æ¥­ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼</h2>
        <div id="calendar" class="info-card calendar-container"></div>
      </section>

      <section class="links-section">
        <h2>ğŸ”— ä¾¿åˆ©ãªãƒªãƒ³ã‚¯</h2>
        <div class="link-cards">
          <a href="reservation.html" class="link-card">
            <div class="link-icon">ğŸ“</div>
            <h3>äºˆç´„ã‚µã‚¤ãƒˆ</h3>
          </a>
          <a href="chatgpt.html" class="link-card">
            <div class="link-icon">ğŸ¤–</div>
            <h3>é£Ÿå ‚å°‚ç”¨ChatGPT</h3>
          </a>
        </div>
      </section>

      <section class="info-section">
        <h2>ğŸ”— URLãƒªãƒ³ã‚¯</h2>
        <div id="page-links" class="info-card"></div>
      </section>
    </main>

    <footer>
      <p>&copy; 2025 å­¦æ ¡é£Ÿå ‚ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ </p>
    </footer>
  </div>

  <script>
    function loadStatus() {
      const holidays = JSON.parse(localStorage.getItem("holidays") || "[]");
      const statusDiv = document.getElementById("status-display");
      const today = new Date().toISOString().split("T")[0];
      const todayHoliday = holidays.find(h => h.date === today);

      if (todayHoliday) {
        statusDiv.innerHTML = `<p>ğŸš« æœ¬æ—¥ï¼ˆ${today}ï¼‰ã¯ä¼‘æ¥­ã§ã™ã€‚<br>ç†ç”±: ${todayHoliday.reason}</p>`;
      } else {
        statusDiv.innerHTML = `<p>âœ… æœ¬æ—¥ã¯å–¶æ¥­ä¸­ã§ã™ã€‚</p>`;
      }

      // ä»Šå¾Œã®ä¼‘æ¥­æ—¥
      const listDiv = document.getElementById("holidays-list");
      if (holidays.length === 0) {
        listDiv.innerHTML = "<p>ç™»éŒ²ã•ã‚ŒãŸä¼‘æ¥­æ—¥ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚</p>";
        return;
      }
      listDiv.innerHTML = holidays
        .map(h => `<p>ğŸ“… ${h.date}ã€€ğŸ“ ${h.reason}</p>`)
        .join("");
    }

    // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚’ç”Ÿæˆ
    function generateCalendar() {
      const calendarDiv = document.getElementById('calendar');
      const holidays = JSON.parse(localStorage.getItem("holidays") || "[]");
      const today = new Date();
      const currentMonth = today.getMonth();
      const currentYear = today.getFullYear();
      
      // æœˆã®æœ€åˆã®æ—¥ã¨æœ€å¾Œã®æ—¥ã‚’å–å¾—
      const firstDay = new Date(currentYear, currentMonth, 1);
      const lastDay = new Date(currentYear, currentMonth + 1, 0);
      const daysInMonth = lastDay.getDate();
      const startingDayOfWeek = firstDay.getDay();
      
      // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ãƒ˜ãƒƒãƒ€ãƒ¼
      const monthNames = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', 
                         '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
      const dayNames = ['æ—¥', 'æœˆ', 'ç«', 'æ°´', 'æœ¨', 'é‡‘', 'åœŸ'];
      
      let calendarHTML = `
        <div class="calendar-header">
          <h4>${currentYear}å¹´ ${monthNames[currentMonth]}</h4>
        </div>
        <div class="calendar-grid">
          <div class="calendar-weekdays">
      `;
      
      // æ›œæ—¥ãƒ˜ãƒƒãƒ€ãƒ¼
      dayNames.forEach(day => {
        calendarHTML += `<div class="calendar-weekday">${day}</div>`;
      });
      calendarHTML += `</div><div class="calendar-days">`;
      
      // ç©ºç™½ã®æ—¥ä»˜ï¼ˆæœˆã®æœ€åˆã®æ—¥ã‚ˆã‚Šå‰ï¼‰
      for (let i = 0; i < startingDayOfWeek; i++) {
        calendarHTML += `<div class="calendar-day empty"></div>`;
      }
      
      // å®Ÿéš›ã®æ—¥ä»˜
      for (let day = 1; day <= daysInMonth; day++) {
        const dateString = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
        const dayOfWeek = new Date(currentYear, currentMonth, day).getDay();
        const isHoliday = holidays.find(h => h.date === dateString);
        const isSunday = dayOfWeek === 0;
        const isSaturday = dayOfWeek === 6;
        
        let dayClass = 'calendar-day';
        let dayContent = day;
        
        if (isHoliday) {
          dayClass += ' holiday';
          dayContent = `${day}<br><small>${isHoliday.reason}</small>`;
        } else if (isSunday) {
          dayClass += ' sunday';
        } else if (isSaturday) {
          dayClass += ' saturday';
        } else {
          dayClass += ' weekday';
        }
        
        calendarHTML += `<div class="${dayClass}">${dayContent}</div>`;
      }
      
      calendarHTML += `</div></div>`;
      calendarDiv.innerHTML = calendarHTML;
    }

    function renderLinks() {
      const base = window.location.href.replace(/[^/]*$/, '');
      const pages = [
        { name: 'ç”Ÿå¾’ç”¨ã‚µã‚¤ãƒˆ (index.html)', file: 'index.html' },
        { name: 'äºˆç´„ã‚µã‚¤ãƒˆ (reservation.html)', file: 'reservation.html' },
        { name: 'é£Ÿå ‚å°‚ç”¨ChatGPT (chatgpt.html)', file: 'chatgpt.html' }
      ];
      const linksDiv = document.getElementById('page-links');
      if (!linksDiv) return;
      linksDiv.innerHTML = pages.map(p => {
        const url = base + p.file;
        return `<p><strong>${p.name}:</strong> <a href="${url}">${url}</a></p>`;
      }).join('');
    }

    window.onload = function() {
      loadStatus();
      generateCalendar();
      renderLinks();
    };
  </script>
</body>
</html>
